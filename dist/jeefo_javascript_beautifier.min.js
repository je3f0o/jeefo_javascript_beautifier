/**
 * jeefo_javascript_beautifier : v0.0.1
 * Author                      : je3f0o, <je3f0o@gmail.com>
 * Homepage                    : https://github.com/je3f0o/jeefo_javascript_beautifier
 * License                     : The MIT License
 * Copyright                   : 2017
 **/
!function(e,t,r){"use strict";e.use(function(){var t=e.module("jeefo_core",[]),r=function(e){return e.replace(/[A-Z]/g,function(e,t){return(t?"-":"")+e.toLowerCase()})},n=function(e){return e.replace(/[A-Z]/g,function(e,t){return(t?"_":"")+e.toLowerCase()})},s=Object.prototype.toString,i=Function.toString,a=/^\[object .+?Constructor\]$/,o=/^function.*?\(\) \{ \[native code\] \}$/,c=function(e){return"[object Date]"===s.call(e)},h=function(e){return"[object RegExp]"===s.call(e)},p=function(e,t){return(t?/^\d+(?:.\d+)?$/:/^\-?\d+(?:.\d+)?$/).test(e)},l=function(e,t){return(t?/^\d+$/:/^\-?\d+$/).test(e)},u=function(e){var t=typeof e;return"function"===t?o.test(i.call(e)):e&&"object"===t&&a.test(s.call(e))||!1},d=function(e){try{return JSON.parse(e)}catch(e){}};t.extend("namespace",["$injector","make_injectable"],function(e,t){return function(r){for(var n,s,i=r.split("."),a=i.pop(),o=0,c="";o<i.length;++o)n=i[o],c&&(s=e.resolve_sync(c)),c=c?c+"."+n:n,e.has(c)||(e.register(c,{fn:function(){return{}}}),s&&(s[n]=e.resolve_sync(c)));return e.register(r,t.apply(null,arguments)),c&&(s=e.resolve_sync(c),s[a]=e.resolve_sync(r)),this}}).namespace("transform.dash_case",function(){return r}).namespace("transform.snake_case",function(){return n}).extend("curry",["$injector","make_injectable","transform.snake_case"],function(e,t,r){return function(n){return e.register(r(n+"Curry"),t.apply(null,arguments)),this}}).extend("run",["$injector","$q","Array"],function(e,t,r){var n=this;return function(s,i){if("function"===typeof s)s.call(this);else if("string"===typeof s)e.resolve(s).then(function(e){i.call(n,e)});else{var a=new r(s.length);t.for_each_async(s,function(t,r,n){e.resolve(t).then(function(e){a[r]=e,n()})}).then(function(){i.apply(n,a)})}return this}}).extend("factory",["$injector","make_injectable","transform.snake_case"],function(e,t,r){return function(n){return e.register(r(n+"Factory"),t.apply(null,arguments)),this}}).extend("service",["$injector","make_injectable","transform.snake_case"],function(e,t,r){return function(n){var s=t.apply(null,arguments);return s.is_constructor=!0,e.register(r(n+"Service"),s),this}}).run("$injector",function(e){e.register("is_date",{fn:function(){return c}}).register("is_regex",{fn:function(){return h}}).register("is_digit",{fn:function(){return p}}).register("is_digit_int",{fn:function(){return l}}).register("is_native",{fn:function(){return u}}).register("json_parse",{fn:function(){return d}})})}),e.use(function(){var t=function(){};t.prototype={error:function(e){var t=new SyntaxError(e);throw t.value=this.value,t.lineNumber=this.start.line,t.columnNumber=this.start.column,t},error_unexpected_type:function(){this.error("Unexpected "+this.type)},error_unexpected_token:function(){this.error("Unexpected token")}};var r=function(e){this.type=e.type,this.name=e.name||e.type,this.start=e.start,this.end=e.end,e.skip&&(this.skip=e.skip),e.until&&(this.until=e.until),e.keepend&&(this.keepend=e.keepend),e.contains&&(this.contains=e.contains),e.contained&&(this.contained=e.contained),e.escape_char&&(this.escape_char=e.escape_char),e.contains&&(this.contains_chars=this.find_special_characters(e.contains))};r.prototype={RegionDefinition:r,copy:function(){return new this.RegionDefinition(this)},find_special_characters:function(e){for(var t=e.length-1;t>=0;--t)if("SpecialCharacter"===e[t].type)return e[t].chars.join("")}};var n=function(e){this.hash={},this.language=e,this.global_null_regions=[],this.contained_null_regions=[]};n.prototype={RegionDefinition:r,sort_function:function(e,t){return e.start.length-t.start.length},register:function(e){if(e=new this.RegionDefinition(e),e.start)this.hash[e.start[0]]?(this.hash[e.start[0]].push(e),this.hash[e.start[0]].sort(this.sort_function)):this.hash[e.start[0]]=[e];else if(e.contained)this.contained_null_regions.push(e);else{if(this.global_null_region)throw Error("Overwritten global null region.");this.global_null_region=e}},find:function(e,t){var r,n,s,i=0,a=this.hash[t.current()];if(e&&e.contains){if(a)e:for(i=a.length-1;i>=0;--i)for(n=e.contains.length-1;n>=0;--n)if(a[i].type===e.contains[n].type){for(r=a[i].start,s=r.length-1;s>=1;--s)if(t.peek(t.current_index+s)!==r.charAt(s))continue e;return a[i].copy()}for(i=e.contains.length-1;i>=0;--i)for(n=this.contained_null_regions.length-1;n>=0;--n)if(this.contained_null_regions[n].type===e.contains[i].type)return this.contained_null_regions[n].copy()}else{if(a)e:for(i=a.length-1;i>=0;--i)if(!a[i].contained){for(r=a[i].start,s=r.length-1;s>=1;--s)if(t.peek(t.current_index+s)!==r.charAt(s))continue e;return a[i].copy()}if(this.global_null_region)return this.global_null_region.copy()}}};var s=function(e){this.string=e,this.current_index=0};s.prototype={peek:function(e){return this.string.charAt(e)},seek:function(e,t){return this.string.substring(e,e+t)},next:function(){return this.peek(++this.current_index)},current:function(){return this.peek(this.current_index)}};var i=function(e,t){this.lines=[{number:1,index:0}],this.start={line:1,column:1},this.tokens=[],this.stack=[],this.regions=t,this.language=e};i.prototype={is_array:Array.isArray,parse:function(e){for(var t,r=this.streamer=new s(e),n=r.current();n;){if(this.current_region){if(n===this.current_region.escape_char){n=r.next();continue}if(this.region_end(this.current_region)){this.current_token=this.current_token.parent,this.current_region=this.current_region.parent,n=r.next();continue}}t=this.regions.find(this.current_region,r),t?(this.parse_region(t),t.keepend&&this.stack.push({token:this.current_token,region:t})):n<=" "?this.handle_new_line(n):n>="0"&&n<="9"?this.parse_number():-1===this.SPECIAL_CHARACTERS.indexOf(n)?this.parse_identifier():this.parse_special_character(),n=r.next()}return this.tokens},parse_number:function(){var e,t=this.streamer;for(this.prepare_new_token(t.current_index),e=t.next();e>="0"&&e<="9";e=t.next());this.add_token(this.make_token("Number")),this.streamer.current_index-=1},SPECIAL_CHARACTERS:[",",".",";",":","<",">","~","`","!","@","#","|","%","^","&","*","(",")","-","+","=","[","]","/","?",'"',"{","}","_","'","\\"].join(""),parse_identifier:function(){var e,t=this.streamer;for(this.prepare_new_token(t.current_index),e=t.next();e>" "&&-1===this.SPECIAL_CHARACTERS.indexOf(e);e=t.next());this.add_token(this.make_token("Identifier")),t.current_index-=1},parse_region:function(e){var t,r,n,s,i=this.streamer;if(this.prepare_new_token(i.current_index),e.start&&(i.current_index+=e.start.length),e.contains)return s=this.make_token(e.type,e.name),s.children=[],this.current_token?(e.parent=this.current_region,s.parent=this.current_token,this.current_token.children.push(s)):this.tokens.push(s),this.current_token=s,this.current_region=e,void(e.start&&(i.current_index-=1));for(n=i.current();n;)if(this.handle_new_line(n),n!==e.escape_char){if(e.skip&&n===e.skip.charAt(0)){for(t=1,r=!0;t<e.skip.length;++t)if(i.peek(i.current_index+t)!==e.skip.charAt(t)){r=!1;break}if(r){i.current_index+=e.skip.length,n=i.current();continue}}if(this.region_end(e,!0))return;n=i.next()}else i.current_index+=2,n=i.current()},parse_special_character:function(){!this.current_region||this.current_region.contains_chars&&-1!==this.current_region.contains_chars.indexOf(this.streamer.current())||(this.prepare_new_token(this.streamer.current_index),this.streamer.current_index+=1,this.make_token("SpecialCharacter").error_unexpected_token()),this.prepare_new_token(this.streamer.current_index),this.streamer.current_index+=1,this.add_token(this.make_token("SpecialCharacter")),this.streamer.current_index-=1},region_end:function(e,t){var r=0;if(this.is_array(e.end))for(;r<e.end.length;++r)if(this.check_end_token(e,e.end[r],t))return this.finallzie_region(e),!0;return this.check_end_token(e,e.end,t)?(this.finallzie_region(e),!0):!!this.region_end_stack(e,t)||void 0},finallzie_region:function(e){for(var t=0;t<this.stack.length;++t)this.stack[t].region===e&&(this.current_token=this.stack[t].token,this.current_region=this.stack[t].region,this.stack.splice(t,this.stack.length))},region_end_stack:function(e,t){for(var r,n=this.stack.length-1;n>=0;--n)if(this.is_array(this.stack[n].region.end)){for(r=0;r<this.stack[n].region.end.length;++r)if(this.check_end_token(e,this.stack[n].region.end[r],t))return this.finallzie_region(this.stack[n].region),!0}else if(this.check_end_token(e,this.stack[n].region.end,t))return this.finallzie_region(this.stack[n].region),!0},check_end_token:function(e,t,r){var n=1,s=this.streamer;if(s.current()===t.charAt(0)){for(;n<t.length;++n)if(s.peek(s.current_index+n)!==t.charAt(n))return!1;if(e.until||(s.current_index+=t.length),r){var i=this.make_token(e.type,e.name);this.set_value(i,e.start?e.start.length:0,e.until?0:t.length),this.add_token(i)}else this.set_end(this.current_token),this.set_value(this.current_token,e.start?e.start.length:0,e.until?0:t.length);return s.current_index-=1,!0}},handle_new_line:function(e){"\r"!==e&&"\n"!==e||this.new_line()},new_line:function(){this.lines.push({number:this.lines.length+1,index:this.streamer.current_index+1})},set_value:function(e,t,r){e.value=this.streamer.seek(e.start.index+t,e.end.index-e.start.index-t-r)},set_end:function(e){e.end.line=this.lines.length,e.end.column=this.streamer.current_index-this.lines[this.lines.length-1].index,e.end.index=this.streamer.current_index},prepare_new_token:function(e){this.start={line:this.lines.length,column:e-this.lines[this.lines.length-1].index+1,index:e}},add_token:function(e){this.current_token?this.current_token.children.push(e):this.tokens.push(e)},make_token:function(e,r){var n=this.start.index,s=this.streamer.current_index-this.start.index,i=new t;return i.type=e,i.name=r||e,i.value=this.streamer.seek(n,s),i.start=this.start,i.end={line:this.lines.length,column:this.streamer.current_index-this.lines[this.lines.length-1].index+1,virtual_column:this.lines.column,index:this.streamer.current_index},i}},e.module("jeefo_tokenizer",["jeefo_core"]).namespace("tokenizer.Token",function(){return t}).namespace("tokenizer.Region",function(){return n}).namespace("tokenizer.TokenParser",function(){return i})}),e.use(function(){var t=e.module("jeefo_javascript_parser",["jeefo_tokenizer"]);t.namespace("javascript.es5_regions",["tokenizer.Region"],function(e){var t=new e("javascript");return t.register({type:"Comment",name:"Inline comment",start:"//",end:"\n"}),t.register({type:"Comment",name:"Multi line comment",start:"/*",end:"*/"}),t.register({type:"String",name:"Double quote string",start:'"',escape_char:"\\",end:'"'}),t.register({type:"String",name:"Single quote string",start:"'",escape_char:"\\",end:"'"}),t.register({type:"TemplateLiteral quasi string",start:null,end:"${",until:!0,contained:!0}),t.register({type:"TemplateLiteral expression",start:"${",end:"}",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"RegExp"},{type:"Comment"},{type:"Parenthesis"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">","\\",":",".",",",";"]}]}),t.register({type:"TemplateLiteral",start:"`",escape_char:"\\",end:"`",contains:[{type:"TemplateLiteral quasi string"},{type:"TemplateLiteral expression"}],keepend:!0}),t.register({type:"Parenthesis",name:"Parenthesis",start:"(",end:")",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"RegExp"},{type:"Comment"},{type:"Parenthesis"},{type:"TemplateLiteral"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">","\\",":",".",",",";"]}]}),t.register({type:"Array",name:"Array literal",start:"[",end:"]",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"Comment"},{type:"Parenthesis"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">",":",".",",",";"]}]}),t.register({type:"Block",name:"Block",start:"{",end:"}",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"RegExp"},{type:"Comment"},{type:"Parenthesis"},{type:"TemplateLiteral"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">","\\",":",".",",",";"]}]}),t.register({type:"RegExp",name:"RegExp",start:"/",skip:"\\/",end:"/"}),t}),t.namespace("javascript.tokenizer",["tokenizer.TokenParser","javascript.es5_regions"],function(e,t){return function(r){return new e("javascript",t).parse(r)}}),t.namespace("javascript.Parser",["javascript.tokenizer","tokenizer.Token"],function(e,t){var r=["break","continue","return","do","for","while","switch","case","default","in","typeof","instanceof","try","catch","finally","throw","var","function","this","new","debugger","if","else","with","delete","void"],n=function(e,t){this.reserved=r,e&&(this.statement_middlewares=e),t&&(this.expression_middlewares=t)},s=n.prototype;s.EmptyStatement=function(e){this.type="EmptyStatement",this.start=e.start,this.end=e.end},s.IfStatement=function(e,t,r,n,s){this.type="IfStatement",this.test=r,this.statement=n,this.alternate=s||null,this.start=e,this.end=t},s.ForStatement=function(e,t,r,n,s,i){this.type="ForStatement",this.init=r,this.test=n,this.update=s,this.statement=i,this.start=e,this.end=t},s.ForInStatement=function(e,t,r,n,s){this.type="ForInStatement",this.left=r,this.right=n,this.statement=s,this.start=e,this.end=t},s.WhileStatement=function(e,t,r,n){this.type="WhileStatement",this.test=r,this.statement=n,this.start=e,this.end=t},s.SwitchStatement=function(e,t,r,n){this.type="SwitchStatement",this.test=r,this.cases=n,this.start=e,this.end=t},s.LabeledStatement=function(e,t,r,n){this.type="LabeledStatement",this.label=r,this.statement=n,this.start=e,this.end=t},s.TryStatement=function(e,t,r,n,s){this.type="TryStatement",this.block=r,this.handler=n,this.finalizer=s,this.start=e,this.end=t},s.ThrowStatement=function(e,t,r){this.type="ThrowStatement",this.argument=r,this.start=e,this.end=t},s.ReturnStatement=function(e,t,r){this.type="ReturnStatement",this.argument=r,this.start=e,this.end=t},s.BreakStatement=function(e,t,r){this.type="BreakStatement",this.label=r,this.start=e,this.end=t},s.ContinueStatement=function(e,t,r){this.type="ContinueStatement",this.label=r,this.start=e,this.end=t},s.ExpressionStatement=function(e,t,r){this.type="ExpressionStatement",this.expression=r,this.start=e,this.end=t},s.BlockStatement=function(e,t){this.type="BlockStatement",this.body=t,this.start=e.start,this.end=e.end},s.ProgramStatement=function(e,t,r){this.type="ProgramStatement",this.body=r,this.start=e,this.end=t},s.NumberLiteral=function(e){this.type="NumberLiteral",this.value=e.value,this.start=e.start,this.end=e.end},s.StringLiteral=function(e){this.type="StringLiteral",this.value=e.value,this.start=e.start,this.end=e.end},s.ArrayLiteral=function(e,t){this.type="ArrayLiteral",this.elements=t,this.start=e.start,this.end=e.end},s.RegExpLiteral=function(e,t,r,n){this.type="RegExpLiteral",this.regex={pattern:r,flags:n},this.start=e,this.end=t},s.ObjectLiteral=function(e,t){this.type="ObjectLiteral",this.properties=t,this.start=e.start,this.end=e.end},s.MemberExpression=function(e,t,r,n,s){this.type="MemberExpression",this.object=r,this.property=n,this.is_computed=!!s,this.start=e,this.end=t},s.CallExpression=function(e,t,r,n){this.type="CallExpression",this.callee=r,this.arguments=n,this.start=e,this.end=t},s.NewExpression=function(e,t,r,n){this.type="NewExpression",this.callee=r,this.arguments=n,this.start=e,this.end=t},s.UnaryExpression=function(e,t,r,n,s){this.type="UnaryExpression",this.operator=r,this.argument=n,this.is_prefix=!!s,this.start=e,this.end=t},s.LogicalExpression=function(e,t,r,n,s){this.type="LogicalExpression",this.operator=n,this.left=r,this.right=s,this.start=e,this.end=t},s.BinaryExpression=function(e,t,r,n,s){this.type="BinaryExpression",this.operator=n,this.left=r,this.right=s,this.start=e,this.end=t},s.AssignmentExpression=function(e,t,r,n,s){this.type="AssignmentExpression",this.operator=n,this.left=r,this.right=s,this.start=e,this.end=t},s.ConditionalExpression=function(e,t,r,n,s){this.type="ConditionalExpression",this.test=r,this.consequent=n,this.alternate=s,this.start=e,this.end=t},s.SequenceExpression=function(e){this.type="SequenceExpression",this.expressions=e,this.start=e[0].start,this.end=e[e.length-1].end},s.FunctionExpression=function(e,t,r,n,s){this.type="FunctionExpression",this.id=r,this.parameters=n,this.body=s,this.start=e,this.end=t},s.VariableDeclaration=function(e,t,r){this.type="VariableDeclaration",this.declarations=r,this.start=e,this.end=t},s.VariableDeclarator=function(e){this.type="VariableDeclarator",this.id=e,this.init=null,this.start=e.start,this.end=e.end},s.FunctionDeclaration=function(e,t,r,n,s){this.type="FunctionDeclaration",this.id=r,this.parameters=n,this.body=s,this.start=e,this.end=t},s.Comment=function(e){this.type="Comment",this.comment=e.value,this.start=e.start,this.end=e.end},s.Property=function(e,t){this.type="Property",this.key=e,this.value=null,this.is_computed=!!t,this.start=e.start},s.CatchClause=function(e,t,r,n){this.type="CatchClause",this.param=r,this.body=n,this.start=e,this.end=t},s.SwitchCase=function(e,t,r,n){this.type="SwitchCase",this.test=r,this.statements=n,this.start=e,this.end=t},s.DefaultCase=function(e,t,r){this.type="DefaultCase",this.statements=r,this.start=e,this.end=t},s.Identifier=function(e){this.type="Identifier",this.name=e.value,this.start=e.start},s.Operator=function(e){this.type="Operator",this.operator=e},s.Piece=function(e){this.start_token=e},s.Temp=function(){},s.File=function(e,t,r){this.type="File",this.name=e,this.code=t,this.program=r},s.Program=function(e){this.type="Program",this.body=e,this.start=e.length?e[0].start:{line:1,column:1,index:0},this.end=e.length?e[e.length-1].end:{line:1,column:1,index:0}},s.parse=function(t,r){this.raw_tokens=e(r);var n=this.parse_block_statement(this.raw_tokens);return new this.File(t,r,new this.Program(n))},s.parse_statement=function(e,t,r){for(var n,s=r;s<t.length;++s)switch(t[s].type){case"Identifier":if(s===r)switch(s=this.parse_identifier(e,t,s),e.identifier.name){case"function":return this.parse_function_declaration(e,t,r);case"var":return this.parse_variable_declaration(e,t,r,t.length);case"throw":return this.parse_statement_has_expression_argument(e,t,r,this.ThrowStatement);case"return":return this.parse_statement_has_expression_argument(e,t,r,this.ReturnStatement);case"if":return this.parse_if_statement(e,t,r);case"for":return this.parse_for_statement(e,t,r);case"while":return this.parse_while_statement(e,t,r);case"switch":return this.parse_switch_statement(e,t,r);case"try":return this.parse_try_statement(e,t,r);case"break":return this.parse_statement_has_label(e,t,r,this.BreakStatement);case"continue":return this.parse_statement_has_label(e,t,r,this.ContinueStatement)}break;case"Block":if(s===r)return e.statement=new this.BlockStatement(t[r],this.parse_block_statement(t[r].children)),s;break;case"Parenthesis":if(s===r)return this.parse_sequence_expression(e,t[s].children,0,t[s].children.length),e.statement=new this.ExpressionStatement(t[s].start,t[s+1].end,e.expression),s+1;break;case"SpecialCharacter":switch(t[s].value){case":":if(!n)return this.parse_labeled_statement(e,t,r);break;case";":return s===r?e.statement=new this.EmptyStatement(t[s]):this.parse_expression_statement(e,t,r,s),s;case"$":case"_":break;default:n=!0}break;case"Comment":return e.statement=new this.Comment(t[s]),s}if(s>r)return this.parse_expression_statement(e,t,r,s),s;throw Error("Executed unreachable code.")},s.parse_if_statement=function(e,t,r,n){var s,i,a,o=r+1;if(t[o]?"Parenthesis"===t[o].type?(s=this.parse_test(e,t[o].children),++o):t[o].error_unexpected_token():n.error_unexpected_token(),t[o]){if(o=this.parse_statement(e,t,o),!e.statement)throw Error("Fallback error");i=e.statement}else n.error_unexpected_token();if(t[o+1]&&"Identifier"===t[o+1].type&&"else"===t[o+1].value){if(!t[o+2])throw Error("Fallback error");o=this.parse_statement(e,t,o+2),a=e.statement}return e.statement=new this.IfStatement(t[r].start,t[o].end,s,i,a),o},s.parse_for_statement=function(e,t,r,n){var s,i,a,o,c,h,p=r+1;if(t[p])if("Parenthesis"===t[p].type){switch(this.parse_for_arguments(e,t[p].children),s=e.type){case"loop":i=e.init,a=e.test,o=e.update;break;case"in":c=e.left,h=e.right;break;default:throw Error("Fallback error")}++p}else t[p].error_unexpected_token();else n.error_unexpected_token();if(t[p]){if(p=this.parse_statement(e,t,p),!e.statement)throw Error("error");switch(s){case"loop":e.statement=new this.ForStatement(t[r].start,t[p].end,i,a,o,e.statement);break;case"in":e.statement=new this.ForInStatement(t[r].start,t[p].end,c,h,e.statement)}}else n.error_unexpected_token();return p},s.parse_while_statement=function(e,t,r,n){var s,i=r+1;if(t[i]?"Parenthesis"===t[i].type?(s=this.parse_test(e,t[i].children),i+=1):t[i].error_unexpected_token():n.error_unexpected_token(),t[i]){if(i=this.parse_statement(e,t,i),!e.statement)throw Error("Fallback error");e.statement=new this.WhileStatement(t[r].start,t[i].end,s,e.statement)}else n.error_unexpected_token();return i},s.parse_switch_statement=function(e,t,r,n){var s,i,a=r+1;if(t[a])if("Parenthesis"===t[a].type){if(this.parse_sequence_expression(e,t[a].children,0,t[a].children.length),!e.expression)throw Error("Fallback error");i=e.expression,a+=1}else t[a].error_unexpected_token();else n.error_unexpected_token();return t[a]?"Block"===t[a].type?s=this.parse_switch_cases(e,t[a].children):t[a].error_unexpected_token():n.error_unexpected_token(),e.statement=new this.SwitchStatement(t[r].start,t[a].end,i,s),a},s.parse_labeled_statement=function(e,t,r){var n,s;if(n=this.parse_identifier(e,t,r),s=e.identifier,!t[n+1])throw Error("Fallback error");return"SpecialCharacter"===t[n+1].type&&":"===t[n+1].value?(n=this.parse_statement(e,t,n+2,!0),e.statement=new this.LabeledStatement(t[r].start,e.statement.end,s,e.statement)):t[n+1].error_unexpected_token(),n},s.parse_try_statement=function(e,t,r,n){var s,i,a,o,c=r+1,h=null,p=null;if(t[c]?"Block"===t[c].type?(i=new this.BlockStatement(t[c],this.parse_block_statement(t[c].children)),++c):t[c].error_unexpected_token():n.error_unexpected_token(),t[c]&&"Identifier"===t[c].type&&"catch"===t[c].value){if(++c,t[c])if("Parenthesis"===t[c].type){if(s=this.parse_identifier(e,t[c].children,0),!e.identifier)throw Error("error");a=e.identifier,t[c].children.length>s+1&&t[c].children[s+1].error_unexpected_token(),c+=1}else t[c].error_unexpected_token();else n.error_unexpected_token();t[c]?"Block"===t[c].type?(o=new this.BlockStatement(t[c],this.parse_block_statement(t[c].children)),h=new this.CatchClause(t[c-2].start,t[c].end,a,o)):t[c].error_unexpected_token():n.error_unexpected_token()}if(t[c+1]&&"Identifier"===t[c+1].type&&"finally"===t[c+1].value)if(c+=2,t[c]){if("Block"!==t[c].type)throw Error("error");p=new this.BlockStatement(t[c],this.parse_block_statement(t[c].children))}else t[c].error_unexpected_token();if(!h&&!p)throw Error("Error");return e.statement=new this.TryStatement(t[r].start,t[c].end,i,h,p),c},s.parse_block_statement=function(e){var t=new this.Temp,r=0,n=[];if(this.statement_middlewares)return this.parse_block_statement_with_middlewares(t,e,n);for(;r<e.length;++r)r=this.parse_statement(t,e,r),n.push(t.statement);return n},s.parse_block_statement_with_middlewares=function(e,t,r){var n,s,i=0;e:for(;i<t.length;++i){for(n=0;n<this.statement_middlewares.length;++n)if((s=this.statement_middlewares[i](this,e,t,i))>i){i=s,r.push(e.statement);continue e}i=this.parse_statement(e,t,i),r.push(e.statement)}return r},s.parse_statement_has_expression_argument=function(e,t,r,n){var s=this.parse_sequence_expression(e,t,r+1,t.length);return e.statement=new n(t[r].start,t[s].end,e.expression),s},s.parse_statement_has_label=function(e,t,r,n){var s=r,i=null;return t[s+1]&&this.is_identifier(t[s+1])&&(s=this.parse_identifier(e,t,s+1),i=e.identifier),t[s+1]&&"SpecialCharacter"===t[s+1].type&&";"===t[s+1].value&&++s,e.statement=new n(t[r].start,t[s].end,i),s},s.parse_expression_statement=function(e,t,r,n){this.parse_sequence_expression(e,t,r,n),t[n]?e.statement=new this.ExpressionStatement(t[r].start,t[n].end,e.expression):e.statement=new this.ExpressionStatement(t[r].start,t[n-1].end,e.expression)},s.parse_number_literal=function(){},s.parse_variable_declaration=function(e,t,r,n){for(var s,i=r+1,a=[],o=!0;i<n;++i)switch(t[i].type){case"Number":t[i].error("Unexpected ILLEGAL token");break;case"Identifier":s&&t[i].error_unexpected_type(),i=this.parse_identifier(e,t,i),s=new this.VariableDeclarator(e.identifier),o=!1;break;case"SpecialCharacter":switch(t[i].value){case"=":if(s){if(!t[i+1])throw new Error("Fallback error");i=this.parse_expression(e,t,i+1,n),s.end=e.expression.end_token.end,s.init=e.expression.parsed_token,a.push(s),s=null}else t[i].error_unexpected_token();break;case"$":case"_":s&&t[i].error_unexpected_type(),i=this.parse_identifier(e,t,i),s=new this.VariableDeclarator(e.identifier),o=!1;break;case",":s?(a.push(s),s=null):o&&t[i].error_unexpected_token(),o=!0;break;case";":return o&&t[i].error_unexpected_token(),s&&a.push(s),e.statement=new this.VariableDeclaration(t[r].start,t[i].end,a),i;default:t[i].error_unexpected_token()}break;case"Comment":break;default:t[i].error_unexpected_token()}return a.push(s),e.statement=new this.VariableDeclaration(t[r].start,t[i-1].end,a),i-1},s.parse_function_declaration=function(e,t,r){var n,s,i,a=r+1;return t[a]&&(this.is_identifier(t[a])?(a=this.parse_identifier(e,t,a)+1,s=e.identifier):t[a].error_unexpected_token()),t[a]&&("Parenthesis"===t[a].type?(n=this.parse_parameters(e,t[a].children),++a):t[a].error_unexpected_token()),t[a]&&("Block"===t[a].type?i=new this.BlockStatement(t[a],this.parse_block_statement(t[a].children)):t[a].error_unexpected_token()),e.statement=new this.FunctionDeclaration(t[r].start,i.end,s,n,i),a},s.parse_expression=function(e,t,r,n,s){var i=0,a=[];e:for(;r<n;++r){if("SpecialCharacter"===t[r].type)switch(t[r].value){case",":case";":case s:if(0===a.length)return e.expression=null,r;break e}r=this.parse_expression_piece(e,t,r),e.piece.parsed_token&&a.push(e.piece)}for(this.assemble_pieces(a,0);i<a.length;++i)if(a[i]){e.expression=a[i];break}return r-1},s.parse_expression_piece=function(e,t,r){if(e.piece=new this.Piece(t[r]),this.expression_middlewares)for(var n=0;n<this.expression_middlewares.length;++n)if(r=this.expression_middlewares[n](this,e.piece,t,r),e.piece.parsed_token)return e.piece.end_token=t[r],r;switch(t[r].type){case"Number":e.piece.parsed_token=new this.NumberLiteral(t[r]);break;case"String":e.piece.parsed_token=new this.StringLiteral(t[r]);break;case"RegExp":r=this.parse_regex(e.piece,t,r);break;case"Identifier":switch(r=this.parse_identifier(e,t,r),e.identifier.name){case"in":case"void":case"delete":case"typeof":case"instanceof":e.piece.parsed_token=new this.Operator(e.identifier.name);break;default:e.piece.parsed_token=e.identifier}e.piece.start_token=e.piece.end_token=e.token;break;case"Array":case"Block":case"Parenthesis":e.piece.parsed_token={type:t[r].type};break;case"SpecialCharacter":switch(t[r].value){case"_":case"$":r=this.parse_identifier(e,t,r),e.piece.parsed_token=e.identifier,e.piece.start_token=e.piece.end_token=e.token;break;default:r=this.parse_operators(e.piece,t,r)}break;case"Comment":e.piece.parsed_token=null}return e.piece.end_token||(e.piece.end_token=t[r]),r},s.parse_new_expression=function(e,t,r){var n,s=t+1;for(this.assemble_pieces(e,s,r,"Parenthesis");s<e.length;++s)if(e[s]){n=e[s],e[s]=null;break}return"CallExpression"===n.parsed_token.type?e[t].parsed_token=new this.NewExpression(e[t].start_token.start,n.end_token.end,n.parsed_token.callee,n.parsed_token.arguments):e[t].parsed_token=new this.NewExpression(e[t].start_token.start,n.end_token.end,n.parsed_token,[]),e[t].end_token=n.end_token,s},s.parse_unary_expression=function(e,t,r){for(var n,s,i,a=0;a<t.length;++a)switch(s=t[a],e[s].parsed_token.operator){case"--":case"++":return e[s-1]&&e[s-1].parsed_token&&"Operator"!==e[s-1].parsed_token.type&&"NumberLiteral"!==e[s-1].parsed_token.type?(e[s-1].parsed_token=new this.UnaryExpression(e[s-1].start_token.start,e[s].end_token.end,e[s].parsed_token.operator,e[s-1].parsed_token),e[s-1].end_token=e[s].end_token):e[s+1]&&e[s+1].parsed_token&&"Operator"!==e[s+1].parsed_token.type&&"NumberLiteral"!==e[s+1].parsed_token.type&&(e[s+1].parsed_token=new this.UnaryExpression(e[s].start_token.start,e[s+1].end_token.end,e[s].parsed_token.operator,e[s+1].parsed_token,!0),e[s+1].start_token=e[s].start_token),void(e[s]=null);case"+":case"-":case"!":case"~":case"void":case"delete":case"typeof":for(n=s+1;n<e.length;++n)if(e[n]){i=e[n],e[n]=null;break}i||r.error_unexpected_token(),i.parsed_token&&"Operator"===i.parsed_token.type&&i.start_token.error_unexpected_token(),i&&(e[s].parsed_token=new this.UnaryExpression(e[s].start_token.start,i.end_token.end,e[s].parsed_token.operator,i.parsed_token,!0),e[s].end_token=i.end_token)}},s.parse_binary_expression=function(e,t,r){for(var n,s,i,a=0;a<t.length;++a){for(n=t[a]-1;n>=0;--n)if(e[n]){s=e[n],e[n]=null;break}for(n=t[a]+1;n<e.length;++n)if(e[n]){i=e[n],e[n]=null;break}e[t[a]].parsed_token=new r(s.start_token.start,i.end_token.end,s.parsed_token,e[t[a]].parsed_token.operator,i.parsed_token),e[t[a]].start_token=s.start_token,e[t[a]].end_token=i.end_token}},s.parse_member_expression=function(e,t){var r,n,s;switch(e[t].parsed_token.type){case"Operator":for(r=t-1;r>=0;--r)if(e[r]){if(n=e[r],"Parenthesis"===n.parsed_token.type)return!1;e[r]=null;break}for(r=t+1;r>=0;++r)if(e[r]){s=e[r],e[r]=null;break}e[t].parsed_token=new this.MemberExpression(n.start_token.start,s.end_token.end,n.parsed_token,s.parsed_token),e[t].start_token=n.start_token,e[t].end_token=s.end_token;break;case"Array":for(r=t-1;r>=0;--r)if(e[r]&&"Operator"!==e[r].parsed_token.type){if(n=e[r],"Parenthesis"===n.parsed_token.type)return!1;e[r]=null;break}if(s=e[t].parsed_token,this.parse_sequence_expression(s,e[t].start_token.children,0,e[t].start_token.children.length),!s.expression)throw Error("Fallback error");e[t].parsed_token=new this.MemberExpression(n.start_token.start,e[t].end_token.end,n.parsed_token,s.expression,!0),e[t].start_token=n.start_token}return!0},s.parse_function_expression=function(e,t,r){var n,s,i=null,a=t+1;return e[a]?"Identifier"===e[a].parsed_token.type?(i=e[a].parsed_token,e[a]=null,++a):"Parenthesis"!==e[a].parsed_token.type&&e[a].start_token.error_unexpected_token():r.error_unexpected_token(),e[a]?"Parenthesis"===e[a].parsed_token.type?(n=this.parse_parameters(e[a],e[a].start_token.children),e[a]=null,++a):e[a].start_token.error_unexpected_token():r.error_unexpected_token(),e[a]?"Block"===e[a].parsed_token.type?(s=new this.BlockStatement(e[a].start_token,this.parse_block_statement(e[a].start_token.children)),e[a]=null):e[a].start_token.error_unexpected_token():r.error_unexpected_token(),e[t].parsed_token=new this.FunctionExpression(e[t].start_token.start,s.end,i,n,s),a},s.parse_sequence_expression=function(e,t,r,n,s,i){var a=[];if(0===t.length||r>=t.length||"SpecialCharacter"===t[r].type&&";"===t[r].value)return s?e.expressions=a:e.expression=null,r;e:for(;r<n;++r)if(r=this.parse_expression(e,t,r,n,i),e.expression&&a.push(e.expression.parsed_token),t[r+1])if("SpecialCharacter"===t[r+1].type)switch(t[r+1].value){case";":case i:r+=2;break e;case",":++r;break;default:t[r+1].error_unexpected_token()}else t[r+1].error_unexpected_token();return s?e.expressions=a:a.length>1?e.expression=new this.SequenceExpression(a):1===a.length?e.expression=a[0]:e.expression=null,r-1},s.parse_assignment_expression=function(e,t){for(var r,n,s,i=0;i<t.length;++i){for(r=t[i]-1;r>=0;--r)if(e[r]){n=e[r],e[r]=null;break}switch(n.parsed_token.type){case"Identifier":case"MemberExpression":case"AssignmentExpression":break;default:n.start_token.error("Assigning to rvalue")}for(r=t[i]+1;r<e.length;++r)if(e[r]){s=e[r],e[r]=null;break}
e[t[i]].parsed_token=new this.AssignmentExpression(n.start_token.start,s.end_token.end,n.parsed_token,e[t[i]].parsed_token.operator,s.parsed_token),e[t[i]].start_token=n.start_token,e[t[i]].end_token=s.end_token}},s.parse_conditional_expression=function(e,t){for(var r,n,s,i,a,o=0;o<t.length;++o,s=null){for(r=t[o]-1;r>=0;--r)if(e[r]){n=r,s=e[r];break}if(!s)throw Error("Fallback error");if("Operator"===s.parsed_token.type)throw Error("Fallback error");for(r=t[o]+1;r<e.length;++r)if(e[r]){i=e[r],e[r]=null;break}for(r=t[o]+1;r<e.length;++r)if(e[r]){"Operator"===e[r].parsed_token.type?e[r]=null:e[r].start_token.error_unexpected_token();break}for(r=t[o]+1;r<e.length;++r)if(e[r]){a=e[r],e[r]=null;break}e[t[o]]=null,e[n].parsed_token=new this.ConditionalExpression(s.start_token.start,a.end_token.end,s.parsed_token,i.parsed_token,a.parsed_token),e[n].start_token=s.start_token,e[n].end_token=a.end_token}},s.parse_array=function(e){for(var t=0,r=new this.Temp,n=[];t<e.length;++t)"SpecialCharacter"===e[t].type&&","===e[t].value?r.to_add?(n.push(r.expression.parsed_token),r.to_add=!1):n.push(null):(t=this.parse_expression(r,e,t,e.length),r.to_add=!0);return r.to_add&&n.push(r.expression.parsed_token),n},s.parse_switch_cases=function(e,t){var r,n,s,i,a=0,o=[];e:for(;a<t.length;++a){switch(t[a].type){case"Comment":o.push(new this.Comment(t[a]));continue e;case"Identifier":break;default:t[a].error_unexpected_token()}t:switch(t[a].value){case"case":if(r=a,!t[a+1])throw new Error("Fallback error");if("SpecialCharacter"===t[a+1].type&&":"===t[a+1].value?t[a+1].error_unexpected_token():a=this.parse_sequence_expression(e,t,a+1,t.length,!1,":"),!t[a])throw new Error("Fallback error");if("SpecialCharacter"===t[a].type&&":"===t[a].value){if(s=e.expression,i=[],a+1===t.length){o.push(new this.SwitchCase(t[r].start,t[a].end,s,i));break}r:for(n=a+1;n<t.length;++n)switch(t[n].type){case"Comment":break;case"Identifier":switch(t[n].value){case"case":case"default":o.push(new this.SwitchCase(t[r].start,t[a].end,s,i));break t}break r;default:break r}r:for(++a;a<t.length&&(a=this.parse_statement(e,t,a),i.push(e.statement),t[a+1]&&"Identifier"===t[a+1].type);++a)switch(t[a+1].value){case"case":case"default":break r}o.push(new this.SwitchCase(t[r].start,t[a].end,s,i))}else t[a].error_unexpected_token();break;case"default":if(r=a,!t[a+1])throw new Error("Fallback error");if("SpecialCharacter"===t[a+1].type&&":"===t[a+1].value){if(++a,i=[],a+1===t.length){o.push(new this.DefaultCase(t[r].start,t[a].end,i));break}r:for(n=a+1;n<t.length;++n)switch(t[n].type){case"Comment":break;case"Identifier":switch(t[n].value){case"case":case"default":o.push(new this.DefaultCase(t[r].start,t[a].end,i));break t}break r;default:break r}r:for(++a;a<t.length&&(a=this.parse_statement(e,t,a),i.push(e.statement),t[a+1]&&"Identifier"===t[a+1].type);++a)switch(t[a+1].value){case"case":case"default":break r}o.push(new this.DefaultCase(t[r].start,t[a].end,i))}else t[a].error_unexpected_token();break;default:t[a].error_unexpected_token()}}return o},s.parse_operators=function(e,t,r){switch(t[r].value){case".":return e.parsed_token=new this.Operator("."),r;case"-":return"-"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("--"),r+1):"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("-="),r+1):(e.parsed_token=new this.Operator("-"),r);case"+":return"+"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("++"),r+1):"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("+="),r+1):(e.parsed_token=new this.Operator("+"),r);case"/":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("/="),r+1):(e.parsed_token=new this.Operator("/"),r);case"*":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("*="),r+1):(e.parsed_token=new this.Operator("*"),r);case"%":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("%="),r+1):(e.parsed_token=new this.Operator("%"),r);case"=":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?"="===t[r+2].value&&t[r+2].start.index===t[r+1].end.index?(e.parsed_token=new this.Operator("==="),r+2):(e.parsed_token=new this.Operator("=="),r+1):(e.parsed_token=new this.Operator("="),r);case"&":return"&"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("&&"),r+1):(e.parsed_token=new this.Operator("&"),r);case"|":return"|"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("||"),r+1):(e.parsed_token=new this.Operator("|"),r);case">":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator(">="),r+1):(e.parsed_token=new this.Operator(">"),r);case"<":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("<="),r+1):(e.parsed_token=new this.Operator("<"),r);case"!":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?"="===t[r+2].value&&t[r+2].start.index===t[r+1].end.index?(e.parsed_token=new this.Operator("!=="),r+2):(e.parsed_token=new this.Operator("!="),r+1):(e.parsed_token=new this.Operator("!"),r);case"?":case":":return e.parsed_token=new this.Operator(t[r].value),r;default:t[r].error_unexpected_token()}},s.parse_identifier=function(e,r,n){var s=n+1,i=e.token=new t,a=e.identifier=new this.Identifier(r[n]);e:for(;s<r.length;++s)switch(r[s].type){case"Number":case"Identifier":if(r[s-1].end.index!==r[s].start.index)break e;a.name=a.name+r[s].value;break;case"SpecialCharacter":switch(r[s].value){case"$":case"_":if(r[s-1].end.index!==r[s].start.index)break e;a.name=a.name+r[s].value;break;default:break e}break;default:break e}return a.end=r[s-1].end,i.type="Identifier",i.value=a.name,i.start=r[n].start,i.end=r[s-1].end,s-1},s.parse_parenthesis=function(e,t){var r,n,s=0,i=e[t[0]].parsed_token;e:for(;s<t.length;++s)for(r=t[s]-1;r>=0;--r)if(e[r]){"Operator"!==e[r].parsed_token.type?(n=this.parse_arguments(i,e[t[s]].start_token.children),e[t[s]].parsed_token=new this.CallExpression(e[r].start_token.start,e[t[s]].end_token.end,e[r].parsed_token,n),e[t[s]].start_token=e[r].start_token,e[r]=null):(this.parse_sequence_expression(i,e[t[s]].start_token.children,0,e[t[s]].start_token.children.length),e[t[s]].parsed_token=i.expression);continue e}},s.REGEX_FLAGS="gimuy",s.parse_regex=function(e,t,r){var n,s,i=r+1,a=0,o="";if(t[i]&&t[r].end.index===t[i].start.index&&"Identifier"===t[i].type)for(s=t[i].value,n=!0,a=s.length-1;a>=0;--a)-1!==this.REGEX_FLAGS.indexOf(s.charAt(a))&&-1===o.indexOf(s.charAt(a))?o+=s.charAt(a):t[i].error("Invalid regular expression flags");return n||(o="",i=r),e.parsed_token=new this.RegExpLiteral(t[r].start,t[i].end,t[r].value,o),i},s.parse_arguments=function(e,t){return this.parse_sequence_expression(e,t,0,t.length,!0),e.expressions},s.parse_for_arguments=function(e,t){var r=t[0]&&"Identifier"===t[0].type&&"var"===t[0].value,n=r?1:0;if(!t[n])throw Error("error");switch(e.identifier=null,this.is_identifier(t[n])?(n=this.parse_identifier(e,t,n),e.type=t[n+1]&&"in"===t[n+1].value?"in":"loop"):e.type="loop",e.type){case"in":if(e.left=r?new this.VariableDeclaration(t[0].start,e.identifier.end,[new this.VariableDeclarator(e.identifier)]):e.identifier,n=this.parse_sequence_expression(e,t,n+2,t.length),!e.expression)throw Error("error");e.right=e.expression;break;case"loop":if(r?(n=this.parse_variable_declaration(e,t,0,t.length),e.init=e.statement):(n=this.parse_sequence_expression(e,t,0,t.length),e.init=e.expression),"SpecialCharacter"!==t[n].type||";"!==t[n].value)throw Error("ERROR");if(n=this.parse_sequence_expression(e,t,n+1,t.length),e.test=e.expression,"SpecialCharacter"!==t[n].type||";"!==t[n].value)throw Error("ERROR");n=this.parse_sequence_expression(e,t,n+1,t.length),e.update=e.expression}},s.parse_parameters=function(e,t){for(var r=0,n=[];r<t.length;++r)this.is_identifier(t[r])?(r=this.parse_identifier(e,t,r),t[r+1]&&("SpecialCharacter"===t[r+1].type&&","===t[r+1].value?++r:t[r+1].error_unexpected_token()),n.push(e.identifier)):t[r].error_unexpected_token();return n},s.parse_test=function(e,t){if(this.parse_sequence_expression(e,t,0,t.length),e.expression)return e.expression;throw Error("Fallback error")},s.parse_object_literal=function(e){for(var t,r,n=0,s=[],i=new this.Temp,a=e.children;n<a.length;++n)if(t||!this.is_identifier(a[n]))switch(a[n].type){case"Number":t&&a[n].error_unexpected_type(),t=new this.Property(new this.NumberLiteral(a[n])),r=!0;break;case"String":t&&a[n].error_unexpected_type(),t=new this.Property(new this.StringLiteral(a[n])),r=!0;break;case"Array":break;case"SpecialCharacter":switch(a[n].value){case":":r?(n=this.parse_expression(i,a,n+1,a.length),r=!1,t.value=i.expression.parsed_token):t?(n=this.parse_expression(i,a,n+1,a.length),t.value=i.expression.parsed_token):a[n].error_unexpected_token(),s.push(t),t=null;break;case",":r?a[n].error_unexpected_token():t&&(t.value=t.key,t.end=t.value.end,s.push(t),t=null);break;default:a[n].error_unexpected_token()}break;case"Comment":s.push(new this.Comment(a[n]));break;default:a[n].error_unexpected_token()}else n=this.parse_identifier(i,a,n),t=new this.Property(i.identifier);if(t){if(r)throw Error("Fallback error");t.value=t.key,t.end=t.value.end,s.push(t)}return new this.ObjectLiteral(e,s)},s.parse_block=function(e,t){e[t].parsed_token=this.parse_object_literal(e[t].start_token)},s.assemble_pieces=function(e,t,r,n){for(var s=[],i=[],a=[],o=[],c=[],h=[],p=[],l=[],u=[],d=[];t<e.length;++t){switch(e[t].parsed_token.type){case"Identifier":switch(e[t].parsed_token.name){case"new":t=this.parse_new_expression(e,t);break;case"function":t=this.parse_function_expression(e,t)}break;case"Operator":switch(e[t].parsed_token.operator){case"?":u.unshift(t);break;case"&&":case"||":l.push(t);break;case".":s.push({index:t});break;case"!":case"~":case"++":case"--":case"void":case"delete":case"typeof":a.unshift(t);break;case"<":case">":case"<=":case">=":case"==":case"===":case"!=":case"!==":p.push(t);break;case"+":case"-":0===t||e[t-1]&&"Operator"===e[t-1].parsed_token.type?a.unshift(t):c.push(t);break;case"*":case"/":case"%":o.push(t);break;case"=":case"+=":case"-=":case"*=":case"/=":case"%=":case"&=":case"^=":case"|=":case"**=":case"<<=":case">>=":case">>>=":d.push(t)}break;case"Parenthesis":0===t?(this.parse_sequence_expression(e[0],e[0].start_token.children,0,e[0].start_token.children.length),e[0].parsed_token=e[0].expression):i.push(t);break;case"Array":e[t-1]&&"Operator"!==e[t-1].parsed_token.type?s.push({index:t}):e[t].parsed_token=new this.ArrayLiteral(e[t].start_token,this.parse_array(e[t].start_token.children));break;case"Block":this.parse_block(e,t)}if(n&&e[t].parsed_token.type===n)break}for(t=0;t<s.length;++t)s[t].is_parsed=this.parse_member_expression(e,s[t].index);for(i.length&&this.parse_parenthesis(e,i),t=0;t<s.length;++t)s[t].is_parsed||this.parse_member_expression(e,s[t].index);this.parse_unary_expression(e,a),this.parse_binary_expression(e,o,this.BinaryExpression),this.parse_binary_expression(e,c,this.BinaryExpression),this.parse_binary_expression(e,h,this.BinaryExpression),this.parse_binary_expression(e,p,this.BinaryExpression),this.parse_binary_expression(e,l,this.LogicalExpression),this.parse_conditional_expression(e,u),this.parse_assignment_expression(e,d)},s.is_identifier=function(e){return"Identifier"===e.type||"$"===e.value||"_"===e.value},s.error_end_of_file=function(){this.raw_tokens[this.raw_tokens.length-1].error("Unexpected end of file")};var i=function(){this.statement_middlewares=[],this.expression_middlewares=[]};return s=i.prototype,s.JavascriptParser=n,s.clone_middlewares=function(e){for(var t=0,r=new Array(e.length);t<r.length;++t)r[t]=e[t];return r},s.statement=function(e){this.statement_middlewares?this.statement_middlewares.push(e):this.statement_middlewares=[e]},s.expression=function(e){this.expression_middlewares?this.expression_middlewares.push(e):this.expression_middlewares=[e]},s.parse=function(e,t){return new this.JavascriptParser(this.statement_middlewares&&this.clone_middlewares(this.statement_middlewares),this.expression_middlewares&&this.clone_middlewares(this.expression_middlewares)).parse(e,t)},i}),t.namespace("javascript.ES5_parser",["javascript.tokenizer","javascript.Parser"],function(e,t){var r=new t,n=function(){},s=n.prototype;s.TemplateLiteral=function(e,t){this.type="TemplateLiteral",this.body=t,this.start=e.start,this.end=e.end},s.TemplateLiteralString=function(e){this.type="TemplateLiteralString",this.value=e.value,this.start=e.start,this.end=e.end},s.TemplateLiteralExpression=function(e,t){this.type="TemplateLiteralExpression",this.expression=t,this.start=e.start,this.end=e.end},s.parse=function(e,t,r,n){if("TemplateLiteral"===r[n].type){for(var s=[],i=0;i<r[n].children.length;++i)switch(r[n].children[i].type){case"TemplateLiteral quasi string":s.push(new this.TemplateLiteralString(r[n].children[i]));break;case"TemplateLiteral expression":e.parse_sequence_expression(t,r[n].children[i].children,0,r[n].children[i].children.length),s.push(new this.TemplateLiteralExpression(r[n].children[i],t.expression));break;default:r[n].error_unexpected_token()}t.parsed_token=new this.TemplateLiteral(r[n],s)}return n};var i=new n;return r.expression(function(e,t,r,n){return i.parse(e,t,r,n)}),function(e,t){try{return r.parse(e,t)}catch(t){throw t.fileName=e,t.$stack=t.stack,t}}})}),e.use(function(){e.module("jeefo_javascript_beautifier",["jeefo_javascript_parser"]).namespace("javascript.Beautifier",function(){var e=function(e,t){this.indentation=t,this.current_indent=e},t=e.prototype;return t.Constructor=e,t.$new=function(){var e=new this.Constructor(this.indent,this.indentation);return this.middlewares&&ARRAY_COPY(e.middlewares,this.middlewares),e},t.indent=function(){return this.current_indent=this.current_indent+this.indentation,this.current_indent},t.outdent=function(){return this.current_indent=this.current_indent.substring(0,this.current_indent.length-this.indentation.length),this.current_indent},t.middleware=function(e){this.middlewares?this.middlewares.push(e):this.middlewares=[e]},t.compile_binary_expression=function(e,t){switch(e.type){case"BinaryExpression":case"LogicalExpression":switch(t){case"%":case"/":case"*":switch(e.operator){case"%":case"/":case"*":return this.compile(e);default:return"("+this.compile(e)+")"}break;case"-":case"+":switch(e.operator){case"-":case"+":return this.compile(e);default:return"("+this.compile(e)+")"}break;default:return this.compile(e)}}return this.compile(e)},t.SINGLE_QUOTE_REGEX=/'/,t.DOUBLE_QUOTE_REGEX=/"/,t.DOUBLE_QUOTE_REPLACE_REGEX=/"/g,t.get_string=function(e){return""===e?"''":1===e.length?'"'===e?"'\"'":"'"===e?'"\'"':"'"+e+"'":2===e.length&&"\\"===e.charAt(0)?this.SINGLE_QUOTE_REGEX.test(e)?'"'+e+'"':"'"+e+"'":this.DOUBLE_QUOTE_REGEX.test(e)?this.SINGLE_QUOTE_REGEX.test(e)?'"'+e.replace(this.DOUBLE_QUOTE_REPLACE_REGEX,'\\"')+'"':"'"+e+"'":'"'+e+'"'},t.compile=function(e,t){var r,n,s,i,a,o;if(!e)return String(e);if(this||console.log(e),this.middlewares)for(r=0;r<this.middlewares.length;++r)this.middlewares[r](e);if(e.compiled)return e.compiled;switch(e.type){case"Comment":return"/* "+e.comment.trim()+" */";case"EmptyStatement":return"";case"ExpressionStatement":return this.compile(e.expression)+";";case"IfStatement":return i="EmptyStatement"===e.statement.type?";":" "+this.compile(e.statement),"if ("+this.compile(e.test)+")"+i+(e.alternate?" else "+this.compile(e.alternate):"");case"ForStatement":return i="EmptyStatement"===e.statement.type?";":" "+this.compile(e.statement),n=e.init?"VariableDeclaration"===e.init.type?this.compile(e.init):this.compile(e.init)+";":";",e.test?n=n+" "+this.compile(e.test)+";":n+=";",e.update&&(n=n+" "+this.compile(e.update)),"for ("+n+")"+i;case"ForInStatement":return i=this.compile(e.body),";"!==i&&(i=" "+i),n="VariableDeclaration"===e.left.type?this.compile(e.left,!0):this.compile(e.left),"for ("+(n=n+" in "+this.compile(e.right))+")"+i;case"WhileStatement":return i=this.compile(e.body),";"!==i&&(i=" "+i),"while ("+this.compile(e.test)+")"+i;case"SwitchStatement":return this.indent(),i=e.cases.map(this.compile,this).join("n"+this.current_indent),i&&(i="n"+this.current_indent+i),this.outdent(),i&&(i=i+"n"+this.current_indent),"switch ("+this.compile(e.test)+") {"+i+"}";case"BlockStatement":if(a=e.body,a[0]){for(o=this.indent(),i=o+this.compile(a[0]),r=1;r<a.length;++r)i=i+"n"+o+this.compile(a[r]);i="n"+i+"n"+this.outdent()}return"{"+(i||"")+"}";case"TryStatement":return e.handler&&(i=this.compile(e.handler)),e.finalizer&&(i=i+" finally "+this.compile(e.finalizer)),"try "+this.compile(e.block)+i;case"ReturnStatement":return"return"+(e.argument?" "+this.compile(e.argument):"")+";";case"ConditionalExpression":return this.compile(e.test)+" ? "+this.compile(e.consequent)+" : "+this.compile(e.alternate);case"CallExpression":return n=e.arguments.map(this.compile,this).join(", "),this.compile(e.callee)+"("+n+")";case"UnaryExpression":switch(e.operator){case"+":case"-":case"~":return e.operator+this.compile(e.argument);case"!":return i=this.compile(e.argument),"!"===i[0]?"!"+i:"! "+i;case"++":case"--":return e.is_prefix?e.operator+this.compile(e.argument):this.compile(e.argument)+e.operator}return e.operator+" "+this.compile(e.argument);case"SequenceExpression":if(e.expressions[0])for(i=this.compile(e.expressions[0]),r=1;r<e.expressions.length;++r)i=i+", "+this.compile(e.expressions[r]);return i?"("+i+")":"";case"NewExpression":return n=e.arguments.map(this.compile,this).join(", "),"new "+this.compile(e.callee)+"("+n+")";case"BinaryExpression":case"LogicalExpression":return this.compile_binary_expression(e.left,e.operator)+" "+e.operator+" "+this.compile_binary_expression(e.right,e.operator);case"AssignmentExpression":return this.compile(e.left)+" "+e.operator+" "+this.compile(e.right);case"TemplateLiteralExpression":switch(e.expression.type){case"BinaryExpression":case"LogicalExpression":case"ConditionalExpression":return"("+this.compile(e.expression)+")"}return this.compile(e.expression);case"MemberExpression":return e.is_computed?this.compile(e.object)+"["+this.compile(e.property)+"]":this.compile(e.object)+"."+this.compile(e.property);case"FunctionExpression":if(e.parameters[0])for(s=e.parameters[0].name,r=1;r<e.parameters.length;++r)s=s+", "+e.parameters[r].name;return"function "+(e.id?e.id.name+" ":"")+"("+(s||"")+") "+this.compile(e.body);case"StringLiteral":return this.get_string(e.value);case"TemplateLiteralString":return e.value.split("\n").map(this.get_string,this).join(" +\n");case"NumberLiteral":return e.value;case"RegExpLiteral":return"/"+e.regex.pattern+"/"+e.regex.flags;case"ArrayLiteral":if(this.indent(),e.elements.length)for(i=e.elements[0]?this.compile(e.elements[0]):"",r=1;r<e.elements.length;++r)i=e.elements[r]?i+",\n"+this.current_indent+this.compile(e.elements[r]):i+",\n"+this.current_indent+" undefined";return this.outdent(),"["+(i||"")+"]";case"ObjectLiteral":return this.indent(),i=e.properties.map(this.compile,this).join(",\n"),this.outdent(),i&&(i="n"+i+"n"+this.current_indent),"{"+i+"}";case"TemplateLiteral":return e.body.map(this.compile,this).join(" + ");case"SwitchCase":return this.indent(),i=e.statements.map(this.compile,this).join("n"+this.current_indent),i&&(i="n"+this.current_indent+i),this.outdent(),"case "+this.compile(e.test)+":"+i;case"DefaultCase":return this.indent(),i=e.statements.map(this.compile,this).join("n"+this.current_indent),i&&(i="n"+this.current_indent+i),this.outdent(),"default:"+i;case"VariableDeclarator":var c=t-e.id.name.length;if(e.init){for(r=0,o="";r<c;++r)o+=" ";return e.id.name+o+" = "+this.compile(e.init)}return e.id.name;case"VariableDeclaration":this.current_indent+="    ";var h=e.declarations.reduce(function(e,t){return t.id.name.length>e?t.id.name.length:e},0);if(e.declarations[0])for(i=this.compile(e.declarations[0],h),o=this.current_indent+"    ",r=1;r<e.declarations.length;++r)i=i+",\n"+this.current_indent+this.compile(e.declarations[r],h);return this.current_indent=this.current_indent.substring(0,this.current_indent.length-4),t?"var "+i:"var "+i+";\n";case"FunctionDeclaration":if(a=e.body.body,e.parameters[0])for(s=e.parameters[0].name,r=1;r<e.parameters.length;++r)s=s+", "+e.parameters[r].name;return this.current_indent+"function "+e.id.name+" ("+(s||"")+") "+this.compile(e.body)+"n";case"Property":switch(e.key.type){case"Identifier":return this.current_indent+e.key.name+" : "+this.compile(e.value)}return this.current_indent+e.key.name+" : "+this.compile(e.value);case"Identifier":return e.name;case"CatchClause":return" catch ("+this.compile(e.param)+") "+this.compile(e.body);default:console.log("UNIMPLEMENTED token",e.type)}},e})})}(window.jeefo,window,document);